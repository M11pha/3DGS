# NeSVoR

### Paper

#### INTRODUCTION

3D 磁共振成像 (MRI) 在临床检查中发挥着重要作用，但容易受到对象运动造成的伪影的影响。为了解决这个问题，超快速序列（例如单次快速自旋回波 T2 加权成像 [1]）已被开发来“冻结”平面内运动，与多次方法相比，使切片内运动伪影不那么严重。然而，层间运动仍然存在并且仍然是一个问题。因此，为了重建 3D 体积，需要获取不同方向的多个切片堆栈。然后通过切片到体积配准重新对齐这些切片以纠正对象运动，然后使用超分辨率重建进行组合[2]、[3]、[4]。这种切片体积重建 (SVR) 框架在临床实践和图像分析中具有广泛的应用，包括胎儿和新生儿 MRI [4]、[5]、心脏 MRI [6] 和扩散加权 MRI [7]。**现有的 SVR 算法将重建体积明确表示为预定义网格上的离散函数。在此公式中，SVR 的复杂性和内存占用与体积中体素的数量成正比**。例如，将每个维度的体素间距减少一半将使运行时间大约增加八倍。此外，体积的离散表示也可能在重建过程中引入离散化误差。

最近，隐式神经表示（INR）在计算机视觉和图形学的各种任务中越来越受欢迎[8]，[9]。与显式表示相反，INR 将 2D 切片或 3D 体积建模为空间坐标的连续函数，并使用神经网络（例如多层感知器（MLP））对函数进行参数化。 

INR 有几个优点 

i）**它与分辨率无关**，即网络在训练期间学习连续函数，并且能够在推理期间以不同分辨率对体积进行采样。 
ii）**可以通过设计隐式网络的架构将问题的先验知识和约束注入到模型中**[10]。 
iii) **INR 还可以克服密集离散体素网格的高存储成本** [8]。

然而，很少有工作将 INR 应用于 3D MRI 重建，并且用于切片采集的连续前向模型研究也很少。在这里，我们提出了神经切片到体积重建（NeSVoR），这是一种利用隐式神经表示从多个运动损坏的切片堆栈中解决 3D 体积 MR 重建问题的新方法，它允许对重建的图像进行连续且与分辨率无关的表示体积。

#### Related Works

1) Slice-to-Volume Reconstruction:卢梭等人。 [2] 提出了一种 3D 胎儿大脑重建方法，包括三个步骤：i）使用多分辨率切片对齐进行运动校正，ii）对堆栈之间的局部相对强度失真进行强度校正，以及 iii）使用分散插值进行超分辨率重建具有高斯点扩散函数 (PSF)。江等人。 [5]利用多级B样条核改进了分散插值方法。金等人。 [11]提出了一种切片相交运动校正方法，该方法根据切片相交重新对齐切片堆栈，然后采用梯度加权平均步骤进行体积重建。戈利普尔等人。 [3] 将体积重建表述为最大似然误差范数最小化问题，并开发了一种稳健的 M 估计解决方案，减少了所获取数据中潜在异常值的影响。基于这个想法，Kuklisova-Murgasova 等人。 [4] 提出了一种 SVR 方法，使用基于期望最大化（EM）的稳健统计来完全去除异常值。使用额外的强度匹配步骤来补偿不同切片的不一致的缩放因子和偏置场。图尔比尔等人。 [12]通过全变分正则化扩展了[4]中的方法，可以使用原对偶混合梯度（PDHG）方法有效地求解。凯恩斯等人。 [13]基于[4]开发了一种快速重建算法，该算法利用了多个GPU的加速。艾伯纳等人。 [14]提出了一种自动重建框架，包括胎儿大脑定位和分割，并通过删除相似度分数较低的异常值切片来使用一种新颖的切片级异常值拒绝方法。
2) 隐式神经表示：INR的思想在神经渲染中得到了广泛的应用。米尔登霍尔等人。 [8] 提出了神经辐射场（NeRF）来学习具有不同相机位置的 2D 图像的 3D 场景。 NeRF 将密度和 RGB 颜色建模为 5D 空间（3D 空间位置 + 2D 观看方向）中的连续场，并根据体积渲染原理模拟来自辐射场的 2D 观察结果。通过最小化模拟图像和地面真实图像之间的误差来优化网络。为了减轻地面真实相机姿势未知的情况下图像的错位，NeRF−− [15]被提出同时优化相机参数和神经网络。 NeRF-W [16] 引入了图像相关的嵌入向量来对图像之间变化的外观和瞬态对象进行建模。这些嵌入在重建过程中进行了优化，有助于合成对外观和遮挡物变化具有鲁棒性的场景。
            在医学成像领域，人们尝试使用 INR 从 2D 切片重建超分辨体积。 IREM [17] 被提议用于从厚切片堆栈中对成人大脑 MRI 进行超分辨率重建，其中仅考虑堆栈之间的运动。受到 NeRF−− 的启发，Yeung 等人。开发了用于 3D 超声重建的 ImplicitVol [18]。 ImplicitVol 优化了隐式网络和每个切片的刚性变换，以补偿切片间的胎儿运动。然而，上述方法忽略了复杂的切片采集模型以及采集过程中出现的伪影和噪声，因此不能直接应用于胎儿或新生儿MRI。
            此外，众所周知，NeRF 的训练非常耗时。最近的研究表明，==编码层，即隐式网络的输入层，对网络的收敛性有显着影响==[19]，[20]。预定义的编码函数，例如正弦和余弦，需要深度网络和较长的训练时间来适应底层函数。为此，提出了参数编码[20]、[21]，除了网络权重之外，它们还具有可训练的参数。这些参数以稀疏数据结构排列，有助于减少网络深度并显着缩短训练时间[20]。
3) 贡献：在这项工作中，我们提出了 NeSVoR，一种新颖的 SVR 方法，它扩展了 INR，以从被主体运动和图像伪影损坏的多个 2D 切片中学习未知 3D 体积的连续表示。 NeSVoR 的主要贡献是： 
    1）我们使用 INR 将底层体积建模为与分辨率无关的神经网络，并且比显式网格表示更有效，特别是当需要高分辨率体积时。 2) 与 INR 相结合，我们采用连续切片采集模型，该模型考虑了切片间主体运动、PSF 和偏置场。 3）我们还引入了一种通过估计像素级和切片级方差来在重建过程中去除异常值的新方法。 4) 通过 GPU 加速实现，NeSVoR 与基线相比实现了 2 至 10 倍的加速，同时提供了最先进的结果。

